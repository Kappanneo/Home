# i3 config file (v4)
#
# Please see https://i3wm.org/docs/userguide.html for a complete reference!
#
# This config file uses keycodes (bindsym) and was written for the QWERTY
# layout.
#
# To get a config file with the same key positions, but for your current
# layout, use the i3-config-wizard
#

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below.
font pango:monospace 8

# This font is widely installed, provides lots of unicode glyphs, right-to-left
# text rendering and scalability on retina/hidpi displays (thanks to pango).
#font pango:DejaVu Sans Mono 8

# Before i3 v4.8, we used to recommend this one as the default:
# font -misc-fixed-medium-r-normal--13-120-75-75-C-70-iso10646-1
# The font above is very space-efficient, that is, it looks good, sharp and
# clear in small sizes. However, its unicode glyph coverage is limited, the old
# X core fonts rendering does not support right-to-left and this being a bitmap
# font, it doesnâ€™t scale on retina/hidpi displays.

# use these keys for focus, movement, and resize directions when reaching for
# the arrows is not convenient
set $up i
set $down k
set $left j
set $right l

# use Mouse+Mod1 to drag floating windows to their wanted position
floating_modifier Mod1

# for brevity
set $exec exec --no-startup-id

################################  COLORS  ######################################

# class                 border  backgr. text    indicator child_border
client.focused          #4CC97E #4CC97E #ffffff #4CC97E   #4CC97E
client.focused_inactive #222222 #222222 #ffffff #222222   #222222
client.unfocused        #222222 #222222 #888888 #222222   #222222
client.urgent           #222222 #900000 #ffffff #900000   #900000
client.placeholder      #000000 #222222 #ffffff #000000   #222222

client.background       #222222

############################### WORKSPACES #####################################

# workspaces
set $w1 1nternet
set $w2 2rectory
set $w3 3code
set $w4 4terminl
set $w5 5team
set $w6 6kype
set $w7 7nani
set $w8 8volante
set $w9 9a
set $w0 0z

# switch to workspace
bindsym Mod1+1 workspace $w1; exec killall -USR1 i3status
bindsym Mod1+2 workspace $w2; exec killall -USR1 i3status
bindsym Mod1+3 workspace $w3; exec killall -USR1 i3status
bindsym Mod1+4 workspace $w4; exec killall -USR1 i3status
bindsym Mod1+5 workspace $w5; exec killall -USR1 i3status
bindsym Mod1+6 workspace $w6; exec killall -USR1 i3status
bindsym Mod1+7 workspace $w7; exec killall -USR1 i3status
bindsym Mod1+8 workspace $w8; exec killall -USR1 i3status
bindsym Mod1+9 workspace $w9; exec killall -USR1 i3status
bindsym Mod1+0 workspace $w0; exec killall -USR1 i3status

# move focused container to workspace and follow
bindsym Mod1+control+1 move container to workspace $w1; workspace $w1
bindsym Mod1+control+2 move container to workspace $w2; workspace $w2
bindsym Mod1+control+3 move container to workspace $w3; workspace $w3
bindsym Mod1+control+4 move container to workspace $w4; workspace $w4
bindsym Mod1+control+5 move container to workspace $w5; workspace $w5
bindsym Mod1+control+6 move container to workspace $w6; workspace $w6
bindsym Mod1+control+7 move container to workspace $w7; workspace $w7
bindsym Mod1+control+8 move container to workspace $w8; workspace $w8
bindsym Mod1+control+9 move container to workspace $w9; workspace $w9
bindsym Mod1+control+0 move container to workspace $w0; workspace $w0

# exile
bindsym Mod1+x move container to workspace $w9; exec killall -USR1 i3status
bindsym Mod1+control+x workspace $w9; exec killall -USR1 i3status

############################### COMMANDS #######################################

# kill focused window
bindsym Mod1+F4 kill
bindsym Mod1+w kill

# start a terminal
bindsym Mod1+Return split v; exec i3-sensible-terminal
bindsym Mod1+control+Return split h; exec i3-sensible-terminal

# open emacs
bindsym Mod1+e split h; $exec emacs
bindsym Mod1+control+e split v; $exec emacs

# touchpad toggle
set $touchpad_on xinput set-prop "FocalTechPS/2 FocalTech FocalTech Touchpad" "Device Enabled" 1
set $touchpad_off xinput set-prop "FocalTechPS/2 FocalTech FocalTech Touchpad" "Device Enabled" 0
set $touchpad_toggle /home/claudio/bin/touchpad_toggle.sh
bindsym XF86TouchpadToggle $exec $touchpad_toggle
bindsym Mod1+t $exec $touchpad_toggle

# volume
bindsym XF86AudioRaiseVolume $exec amixer -c 1 -q sset Master 1dB+
bindsym XF86AudioLowerVolume $exec amixer -c 1 -q sset Master 1dB-
bindsym XF86AudioMute $exec amixer -c 1 -q -D pulse set Master 1+ toggle

# change focus
bindsym Mod1+$left focus left; exec killall -USR1 i3status #status-bar reset
bindsym Mod1+$down focus down; exec killall -USR1 i3status
bindsym Mod1+$up focus up; exec killall -USR1 i3status
bindsym Mod1+$right focus right; exec killall -USR1 i3status

# alternatively, you can use the cursor keys:
bindsym Mod1+Left focus left; exec killall -USR1 i3status
bindsym Mod1+Down focus down; exec killall -USR1 i3status
bindsym Mod1+Up focus up; exec killall -USR1 i3status
bindsym Mod1+Right focus right; exec killall -USR1 i3status

# move focused window
bindsym Mod1+control+$left move left
bindsym Mod1+control+$down move down
bindsym Mod1+control+$up move up
bindsym Mod1+control+$right move right

# alternatively, you can use the cursor keys:
bindsym Mod1+control+Left move left
bindsym Mod1+control+Down move down
bindsym Mod1+control+Up move up
bindsym Mod1+control+Right move right

# split orientation
bindsym Mod1+h split h
bindsym Mod1+v split v

# fullscreen
bindsym Mod1+f fullscreen toggle

# focus tree
bindsym Mod1+a focus parent
bindsym Mod1+z focus child

# screenshot
bindsym --release Print $exec import /tmp/latest-screenshot.png
bindsym Mod1+p $exec emacs /tmp/latest-screenshot.png

# save layout
bindsym Mod1+y exec i3-save-tree > ~/workspaces/stamp.json; $exec notify-send --expire-time=2000 "Layout saved"
bindsym Mod1+control+y $exec emacs /home/claudio/workspaces/stamp.json

# resize window (you can also use the mouse for that)
bindsym Mod1+minus         resize shrink width  1 px or 1 ppt
bindsym Mod1+control+minus resize shrink height 1 px or 1 ppt
bindsym Mod1+plus          resize grow   width  1 px or 1 ppt
bindsym Mod1+control+plus  resize grow   height 1 px or 1 ppt

# reload the configuration file
bindsym Mod1+control+c reload
# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym Mod1+control+r restart
# exit i3 (logs you out of your X session)
#bindsym Mod1+control+e exec "i3-nagbar -t warning -m 'Exit i3?' -b 'Yes, exit i3' 'i3-msg exit'"

############################### ALERTS #########################################

# if you see one of this there is there is a problem
bindsym Caps_Lock $exec notify-send --expire-time=20000 --urgency=critical CAPS
bindsym Super_L $exec notify-send --expire-time=20000 --urgency=critical SPRL

############################### LAUNCHERS ######################################

# start dmenu (a program launcher)
bindsym Mod1+d exec dmenu_run; $exec notify-send --expire-time=2000 --urgency=critical EXEC

# There also is the (new) i3-dmenu-desktop which only displays applications
# shipping a .desktop file. It is a wrapper around dmenu, so you need that
# installed.
# Since it's slow as **** someone made an actually good one: https://github.com/matteoalessiocarrara/k5-dmenu-desktop
set $dmenu-desktop i3-dmenu-desktop  #/home/claudio/k5-dmenu-desktop

# Super_L is an escape
bindsym Escape $exec $dmenu-desktop; $exec notify-send --expire-time=2000 --urgency=critical EXEC

############################### LAYOUTS ########################################

# chromium bookmarks and apps
#set $chr_com chromium-browser --new-window --profile-directory=Default https://web.telegram.org/ https://web.whatsapp.com/ https://b1-hq.slack.com/
#set $chr_mail chromium-browser --new-window --profile-directory=Default https://outlook.office.com/ https://mail.google.com/ https://mail.libero.it/ https://mail.google.com/mail/u/1/
#set $chr_gh chromium-browser --new-window --profile-directory=Default https://github.com/kappanneo
#set $chr_keep chromium-browser --new-window --profile-directory=Default --app-id=hmjkmjkepdijhoojdojkdfohbdgmmhki

# custom layouts
set $layout_1 exec --no-startup-id "i3-msg 'workspace --no-auto-back-and-forth 1nternet; append_layout /home/claudio/workspaces/1nternet.json'"
set $fill_1 exec --no-startup-id "chromium-browser --new-window --profile-directory=Default https://web.telegram.org/ https://web.whatsapp.com/ & chromium-browser --new-window --profile-directory=Default --app-id=hmjkmjkepdijhoojdojkdfohbdgmmhki; sleep 1; chromium-browser --new-window --profile-directory=Default https://outlook.office.com/ https://mail.google.com/ https://mail.libero.it/ https://mail.google.com/mail/u/1/"

set $layout_2 exec --no-startup-id "i3-msg 'workspace --no-auto-back-and-forth 2rectory; append_layout /home/claudio/workspaces/2rectory.json'"
set $fill_2 exec --no-startup-id "emacs & nautilus & nautilus Downloads & chromium-browser --new-window --profile-directory=Default https://github.com/kappanneo & i3-sensible-terminal"

############################### MODES ##########################################

set $lock "LOCK: alt+space to unlock i3 functionalities"
set $quit "QUIT: esc to resume  q to quit  r to restart  s to suspend  e to exit i3"
set $rdsh "RDSH: alt+r to resume  0-9 to adjust"
set $strt "STRT: alt+s to resume  1-2 layouts"
set $cnfg "CNFG: alt+c to resume  c to i3config  e to emacs  s to statusbar  z to zsh  g to guide  1-2 layouts"

set $resume mode "default" exec --no-startup-id notify-send --expire-time=500 --urgency=critical RESUME; [tiling] border pixel 3
set $mode_exit mode "default" [tiling] border pixel 3
set $in_mode [tiling] border pixel 7
set $in_lock [tiling] border none

# disable touchpad and i3 functionalities while keeping basic ones
mode $lock {
	# exit
	bindsym Mod1+space $mode_exit $exec $touchpad_on & notify-send --expire-time=500 --urgency=critical UNLOCK
	# alert
	bindsym Caps_Lock $exec notify-send --expire-time=20000 --urgency=critical CAPS
	bindsym Super_L $exec notify-send --expire-time=20000 --urgency=critical SPRL
	# volume
	bindsym XF86AudioRaiseVolume $exec amixer -c 1 -q sset Master 1dB+
	bindsym XF86AudioLowerVolume $exec amixer -c 1 -q sset Master 1dB-
	bindsym XF86AudioMute $exec amixer -c 1 -q -D pulse set Master 1+ toggle
	# touchpad
	bindsym XF86TouchpadToggle $exec $touchpad_toggle
	# panic
	bindsym Mod1+F4 kill; exec killall -USR1 i3status
	bindsym XF86PowerOff mode $quit $exec notify-send --expire-time=5000 --urgency=critical $quit
	# in case of mouse
	bindsym --border button2 $mode_exit $exec $touchpad_on & notify-send --expire-time=500 --urgency=critical UNLOCK
	bindsym --border --whole-window Mod1+button2 $mode_exit $exec $touchpad_on & notify-send --expire-time=500 --urgency=critical UNLOCK
}

bindsym Mod1+space mode $lock $exec $touchpad_off & xdotool mousemove 750 3000 & notify-send --expire-time=2000 --urgency=critical $lock; $in_lock
# in case of mouse
bindsym --border button2 mode $lock $exec $touchpad_off & notify-send --expire-time=2000 --urgency=critical $lock; exec killall -USR1 i3status; $in_lock
bindsym --border--whole-window Mod1+button2 mode $lock $exec $touchpad_off & notify-send --expire-time=2000 --urgency=critical $lock; exec killall -USR1 i3status; $in_lock

# quit menu
mode $quit {
	# exit
	bindsym Escape $resume
	# options
	bindsym q $exec shutdown -h now
	bindsym r $exec reboot
	bindsym s $mode_exit $exec systemctl suspend
	bindsym e $exec xmodmap -e "keycode 0x85 = Super_L" & setxkbmap -option; $exec "i3-msg exit"
	# re-notify
	bindsym XF86PowerOff $exec notify-send --expire-time=5000 --urgency=critical $quit
}

bindsym XF86PowerOff mode $quit; $exec notify-send --expire-time=5000 --urgency=critical $quit; $in_mode
# to disable standard poweroff: in /etc/systemd/logind.conf set HandlePowerKey=ignore

# redshift menu
mode $rdsh {
	# exit
	bindsym Mod1+r $resume
	bindsym Escape $resume
	bindsym Mod1+space $resume
	# options
	bindsym backslash $exec redshift -O 2200K
	bindsym 1 $exec redshift -O 2300K
	bindsym 2 $exec redshift -O 2400K
	bindsym 3 $exec redshift -O 2500K
	bindsym 4 $exec redshift -O 2700K
	bindsym 5 $exec redshift -O 3000K
	bindsym 6 $exec redshift -O 3500K
	bindsym 7 $exec redshift -O 4000K
	bindsym 8 $exec redshift -O 4500K
	bindsym 9 $exec redshift -O 5000K
	bindsym 0 $exec redshift -O 6500K
	# panic
	bindsym Mod1+F4 $resume
	bindsym XF86PowerOff mode $quit; $exec notify-send --expire-time=5000 --urgency=critical $quit
	#in case of mouse
	bindsym --border button2 $resume
	bindsym --border --whole-window Mod1+button2 $resume
}

bindsym Mod1+r mode $rdsh; $exec notify-send --expire-time=5000 --urgency=critical $rdsh; $in_mode

# layout launcher
mode $strt {
	# exit
	bindsym Mod1+s $resume
	bindsym Escape $resume
	bindsym Mod1+space $resume
	# options
	bindsym 1 $mode_exit $layout_1; $fill_1
	bindsym 2 $mode_exit $layout_2; $fill_2
	# panic
	bindsym Mod1+F4 $resume
	bindsym XF86PowerOff mode $quit; $exec notify-send --expire-time=5000 --urgency=critical $quit
	#in case of mouse
	bindsym --border button2 $resume
	bindsym --border --whole-window Mod1+button2 $resume
}

bindsym Mod1+s mode $strt; $exec notify-send --expire-time=5000 --urgency=critical $strt; $in_mode

# configuration files launcher
mode $cnfg {
	# exit
	bindsym Mod1+c $resume
	bindsym Escape $resume
	bindsym Mod1+space $resume
	# options
	bindsym c $mode_exit $exec emacs /home/claudio/.config/i3/config
	bindsym e $mode_exit $exec emacs /home/claudio/.emacs
	bindsym s $mode_exit $exec emacs /home/claudio/.config/i3status/config
	bindsym z $mode_exit $exec emacs /home/claudio/.zshrc
	bindsym g $mode_exit $exec chromium-browser --new-window file:///home/claudio/i3_User_Guide.html # from https://i3wm.org/docs/userguide.html
	bindsym 1 $mode_exit $exec emacs /home/claudio/workspaces/1nternet.json
	bindsym 2 $mode_exit $exec emacs /home/claudio/workspaces/2rectory.json
	# panic
	bindsym Mod1+F4 $resume
	bindsym XF86PowerOff mode $quit; $exec notify-send --expire-time=5000 --urgency=critical $quit
	#in case of mouse
	bindsym --border button2 $resume
	bindsym --border --whole-window Mod1+button2 $resume
}

bindsym Mod1+c mode $cnfg; $exec notify-send --expire-time=5000 --urgency=critical $cnfg; $in_mode

############################### BAR ############################################

# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
bar {
        status_command    ./bin/my_status.sh
    	position          bottom
    	mode              dock
    	workspace_buttons yes
    	tray_output       primary
    	colors {
    	           background #000000
    	       	   statusline #999999
    	       	   focused_workspace  #ffffff #000000
    	       	   active_workspace   #ffffff #000000
    	       	   inactive_workspace #888888 #000000
    	       	   urgent_workspace   #ffffff #000000
    	       }
    }

############################### SETTINGS #######################################

# steam
assign [class="Steam"] $w5
for_window [title="Steam - News"] kill
for_window [title="Friends"] resize shrink width 34 px or 34 ppt
for_window [title="Steam"] resize grow width 34 px or 34 ppt

# code
assign [title="Visual Studio Code"] $w3

# nautilus desktop confining
assign [title="Desktop"] $w0

# chromium profile error kill
for_window [title="Profile error occurred"] kill

# skype
assign [class="Skype"] $w6

# texmaker
assign [title="Texmaker"] $w7

# no title-bars
new_window pixel 3
new_float normal

# go back to previous workspace if you try to go to the current one (maybe is good)
workspace_auto_back_and_forth yes

# focus on mouse
focus_follows_mouse yes

############################### STARTUP ########################################

# settings
$exec $touchpad_off
$exec setxkbmap -option ctrl:nocaps; xmodmap -e "keycode 0x85 = Escape"
$exec amixer -c 1 -q -D pulse set Master 1+ mute

# applications
$exec classicmenu-indicator & nm-applet
$exec redshift -O 4500K
$layout_2
$fill_2
