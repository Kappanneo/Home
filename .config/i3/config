
# This font is widely installed, provides lots of unicode glyphs, right-to-left
# text rendering and scalability on retina/hidpi displays (thanks to pango).
#font pango:DejaVu Sans Mono 8

# Before i3 v4.8, we used to recommend this one as the default:
# font -misc-fixed-medium-r-normal--13-120-75-75-C-70-iso10646-1
# The font above is very space-efficient, that is, it looks good, sharp and
# clear in small sizes. However, its unicode glyph coverage is limited, the old
# X core fonts rendering does not support right-to-left and this being a bitmap
# font, it doesnâ€™t scale on retina/hidpi displays.

# use Mouse+Mod1 to drag floating windows to their wanted position
floating_modifier Mod1

# for brevity
set $exec exec --no-startup-id
set $alert notify-send --expire-time=4200 --urgency=critical

############################### KEYBINDINGS ####################################

set $enable_Caps setxkbmap -option
set $disable_Super_L xmodmap -e "keycode 0x85 = Escape"
set $disable_Caps setxkbmap -option ctrl:nocaps

$exec $disable_Caps; $disable_Super_L # order matters

# if you see one of this there is there is a keybinding error
bindsym Caps_Lock $exec $alert CAPS
bindsym Super_L $exec $alert SUPER

############################### WORKSPACES #####################################

# workspaces
set $w1 1nternet
set $w2 2rectory
set $w3 3code
set $w4 4terminl
set $w5 5team
set $w6 6kype
set $w7 7nani
set $w8 8volante
set $w9 9a
set $w0 0z

# switch to workspace (killall forces statusbar update, I use it on every command that changes focus)
bindsym 1 workspace $w1; exec killall -USR1 i3status
bindsym 2 workspace $w2; exec killall -USR1 i3status
bindsym 3 workspace $w3; exec killall -USR1 i3status
bindsym 4 workspace $w4; exec killall -USR1 i3status
bindsym 5 workspace $w5; exec killall -USR1 i3status
bindsym 6 workspace $w6; exec killall -USR1 i3status
bindsym 7 workspace $w7; exec killall -USR1 i3status
bindsym 8 workspace $w8; exec killall -USR1 i3status
bindsym 9 workspace $w9; exec killall -USR1 i3status
bindsym 0 workspace $w0; exec killall -USR1 i3status

# move focused container to workspace and follow (no need for not following with auto back and forth)
bindsym control+1 move container to workspace $w1; workspace $w1
bindsym control+2 move container to workspace $w2; workspace $w2
bindsym control+3 move container to workspace $w3; workspace $w3
bindsym control+4 move container to workspace $w4; workspace $w4
bindsym control+5 move container to workspace $w5; workspace $w5
bindsym control+6 move container to workspace $w6; workspace $w6
bindsym control+7 move container to workspace $w7; workspace $w7
bindsym control+8 move container to workspace $w8; workspace $w8
bindsym control+9 move container to workspace $w9; workspace $w9
bindsym control+0 move container to workspace $w0; workspace $w0

# exile (I use the last workspace for windows such terminals running programs)
bindsym x move container to workspace $w9; exec killall -USR1 i3status
bindsym Shift+x workspace $w9; exec killall -USR1 i3status

############################### LAYOUTS ########################################

# custom layouts
set $layout_1 exec --no-startup-id "i3-msg 'workspace --no-auto-back-and-forth 1nternet; focus parent; focus parent; kill; append_layout /home/claudio/workspaces/1nternet.json'"
set $fill_1 exec --no-startup-id "chromium-browser --new-window --profile-directory=Default https://web.telegram.org/ https://web.whatsapp.com/ & sleep 1; chromium-browser --new-window --profile-directory=Default https://outlook.office.com/ https://mail.google.com/ https://mail.libero.it/ https://mail.google.com/mail/u/1/ https://calendar.google.com/calendar/ & sleep 1; chromium-browser --new-window --profile-directory=Default https://keep.google.com/u/0/ https://getpocket.com/a/queue/list/"

set $layout_2 exec --no-startup-id "i3-msg 'workspace --no-auto-back-and-forth 2rectory; focus parent; focus parent; focus parent; kill; append_layout /home/claudio/workspaces/2rectory.json'"
set $fill_2 exec --no-startup-id "emacs & nautilus & nautilus Downloads & chromium-browser --new-window --profile-directory=Default https://github.com/kappanneo & i3-sensible-terminal"

############################# TOP-COMMANDS #####################################

# touchpad toggle
set $touchpad_on /home/claudio/bin/touchpad_toggle.sh 1
set $touchpad_off xdotool mousemove 750 3000 && /home/claudio/bin/touchpad_toggle.sh 0
set $touchpad_off_2 /home/claudio/bin/touchpad_toggle.sh 0
set $touchpad_toggle /home/claudio/bin/touchpad_toggle.sh
bindsym XF86TouchpadToggle $exec $touchpad_toggle

# volume
bindsym XF86AudioRaiseVolume $exec amixer -c 1 -q sset Master 1dB+
bindsym XF86AudioLowerVolume $exec amixer -c 1 -q sset Master 1dB-
bindsym XF86AudioMute $exec amixer -c 1 -q -D pulse set Master 1+ toggle

# screenshot
set $print "import /tmp/latest-screenshot.png; eog /tmp/latest-screenshot.png"
bindsym --release Print $exec $print

# display
#  ...

############################ BASIC-COMMANDS ####################################

# change focus
bindsym i focus up   ; exec killall -USR1 i3status
bindsym j focus left ; exec killall -USR1 i3status
bindsym k focus down ; exec killall -USR1 i3status
bindsym l focus right; exec killall -USR1 i3status

# alternatively, you can use the cursor keys:
bindsym Up    focus up   ; exec killall -USR1 i3status
bindsym Left  focus left ; exec killall -USR1 i3status
bindsym Down  focus down ; exec killall -USR1 i3status
bindsym Right focus right; exec killall -USR1 i3status

# alternative to the other alternative
bindsym w focus up   ; exec killall -USR1 i3status
bindsym a focus left ; exec killall -USR1 i3status
bindsym s focus down ; exec killall -USR1 i3status
bindsym d focus right; exec killall -USR1 i3status

# also Tab
bindsym Tab focus right; exec killall -USR1 i3status
bindsym Shift+Tab focus left; exec killall -URS1 i3status

# move focused window
bindsym control+i move up
bindsym control+j move left
bindsym control+k move down
bindsym control+l move right

# alternatively, you can use the cursor keys:
bindsym control+Up    move up
bindsym control+Left  move left
bindsym control+Down  move down
bindsym control+Right move right

# alternative to the other alternative
bindsym Shift+w move up
bindsym Shift+a move left
bindsym Shift+s move down
bindsym Shift+d move right

# split orientation
bindsym h split h
bindsym v split v
bindsym g split toggle

# fullscreen
bindsym f fullscreen toggle

# focus tree
bindsym q focus parent
bindsym less focus child

# resize window (you can also use the mouse for that)
bindsym minus         resize shrink height 5 px or 1 ppt
bindsym m             resize shrink width  5 px or 1 ppt
bindsym plus          resize  grow  height 5 px or 1 ppt
bindsym p             resize  grow  width  5 px or 1 ppt

############################### MODES ##########################################

# functional modes
set $super "default"
set $lock "LOCK:  super to unlock i3"
set $quit "QUIT:  esc to resume   q to quit  r to restart  s to suspen  e to exit"

# standardized modes referred as 'mode'
set $rdsh "RDSH:  esc to resume  0-9 to adjust"
set $strt "STRT:  esc to resume  1-2 layouts"
set $cnfg "CNFG:  esc to resume  c config  a applications  e emacs  s statusbar  z zsh  g guide  1-2 or y layouts  p stamp"

set $lock_style  [tiling] border none
set $super_style [tiling] border pixel 3
set $quit_style  [tiling] border pixel 7
set $mode_style  [tiling] border pixel 7

set $alert_super notify-send --expire-time=6000 --urgency=critical "UNLOCK:  space to lock i3"

# disable touchpad and i3 functionalities except basic ones
mode $lock {
	# super
	bindsym Escape mode $super $super_style $exec $touchpad_on & $alert_super
	# quit
	bindsym XF86PowerOff mode $quit $quit_style $exec $alert $quit
	# alert
	bindsym Caps_Lock $exec $alert CAPS
	# volume
	bindsym XF86AudioRaiseVolume $exec amixer -c 1 -q sset Master 1dB+
	bindsym XF86AudioLowerVolume $exec amixer -c 1 -q sset Master 1dB-
	bindsym XF86AudioMute $exec amixer -c 1 -q -D pulse set Master 1+ toggle
	# touchpad
	bindsym XF86TouchpadToggle $exec $touchpad_toggle
	# stamp
	bindsym --release Print $exec $print
	# kill
	bindsym Mod1+F4 kill; exec killall -USR1 i3status
}

bindsym space mode $lock $lock_style $exec $touchpad_off & $alert $lock
bindsym backslash mode $lock $lock_style $exec $touchpad_off & $alert $lock
bindsym Alt_L mode $lock $lock_style $exec $touchpad_off & $alert $lock
bindcode 37 mode $lock $lock_style $exec $touchpad_off & $alert $lock # only bottom-left ctrl
bindsym --border button2 mode $lock $lock_style $exec $touchpad_off_2 & $alert $lock

# quit menu
mode $quit {
	# lock
	bindsym Escape mode $lock $lock_style $exec $alert RESUME
	bindsym space mode $lock $lock_style $exec $alert RESUME
	bindsym backslash mode $lock $lock_style $exec $alert RESUME
	bindsym Alt_L mode $lock $lock_style $exec $alert RESUME
	bindsym Control_L mode $lock $lock_style $exec $alert RESUME
	bindsym --border button2 mode $lock $lock_style $exec $alert RESUME
	# options
	bindsym q $exec shutdown -h now
	bindsym r $exec reboot
	bindsym s mode $lock $lock_style $exec systemctl suspend
	bindsym e $exec $enable_Caps; exit
	# re-notify
	bindsym XF86PowerOff $exec $alert $quit
}

bindsym XF86PowerOff mode $quit $quit_style $exec $alert $quit
# to disable standard poweroff: in /etc/systemd/logind.conf set HandlePowerKey=ignore

# redshift menu
mode $rdsh {
	# super
	bindsym Escape mode $super $super_style $exec $alert_super
	# lock
	bindsym space mode $lock $lock_style $exec $touchpad_off & $alert $lock
	bindsym backslash mode $lock $lock_style $exec $touchpad_off & $alert $lock
	bindsym Alt_L mode $lock $lock_style $exec $touchpad_off & $alert $lock
	bindsym Control_L mode $lock $lock_style $exec $touchpad_off & $alert $lock
	bindsym --border button2 mode $lock $lock_style $exec $touchpad_off_2 & $alert $lock
	# quit
	bindsym XF86PowerOff mode $quit $quit_style $exec $alert $quit
	# options
	bindsym 1 $exec redshift -O 2100K
	bindsym 2 $exec redshift -O 2300K
	bindsym 3 $exec redshift -O 2500K
	bindsym 4 $exec redshift -O 2700K
	bindsym 5 $exec redshift -O 3000K
	bindsym 6 $exec redshift -O 3500K
	bindsym 7 $exec redshift -O 4000K
	bindsym 8 $exec redshift -O 4500K
	bindsym 9 $exec redshift -O 5000K
	bindsym 0 $exec redshift -O 6500K
}

bindsym r mode $rdsh $mode_style $exec $alert $rdsh

# move
mode $strt {
	# super
	bindsym Escape mode $super $super_style $exec $alert_super
	# lock
	bindsym space mode $lock $lock_style $exec $touchpad_off & $alert $lock
	bindsym backslash mode $lock $lock_style $exec $touchpad_off & $alert $lock
	bindsym Alt_L mode $lock $lock_style $exec $touchpad_off & $alert $lock
	bindsym Control_L mode $lock $lock_style $exec $touchpad_off & $alert $lock
	bindsym --border button2 mode $lock $lock_style $exec $touchpad_off_2 & $alert $lock
	# quit
	bindsym XF86PowerOff mode $quit $quit_style $exec $alert $quit
	# options
	bindsym 1 mode $lock $lock_style $exec $touchpad_off & $alert $lock; $layout_1; $fill_1
	bindsym 2 mode $lock $lock_style $exec $touchpad_off & $alert $lock; $layout_2; $fill_2
}

bindsym z mode $strt $mode_style $exec $alert $strt

# configuration files launcher
mode $cnfg {
	# super
	bindsym Escape mode $super $super_style $exec $alert_super
	# lock
	bindsym space mode $lock $lock_style $exec $touchpad_off & $alert $lock
	bindsym backslash mode $lock $lock_style $exec $touchpad_off & $alert $lock
	bindsym Alt_L mode $lock $lock_style $exec $touchpad_off & $alert $lock
	bindsym Control_L mode $lock $lock_style $exec $touchpad_off & $alert $lock
	bindsym --border button2 mode $lock $lock_style $exec $touchpad_off_2 & $alert $lock
	# quit
	bindsym XF86PowerOff mode $quit $quit_style $exec $alert $quit
	# options
	bindsym c mode $lock $lock_style $exec emacs /home/claudio/.config/i3/config & $touchpad_off & $alert $lock
	bindsym a mode $lock $lock_style $exec emacs /sudo::/usr/share/applications/ & $touchpad_off & $alert $lock
	bindsym e mode $lock $lock_style $exec emacs /home/claudio/.emacs & $touchpad_off & $alert $lock
	bindsym s mode $lock $lock_style $exec emacs /home/claudio/.config/i3status/config & $touchpad_off & $alert $lock
	bindsym z mode $lock $lock_style $exec emacs /home/claudio/.zshrc & $touchpad_off & $alert $lock
	bindsym g mode $lock $lock_style $exec chromium-browser --new-window file:///home/claudio/i3_User_Guide.html & $touchpad_off & $alert $lock # from https://i3wm.org/docs/userguide.html
	bindsym y mode $lock $lock_style $exec emacs /home/claudio/workspaces/stamp.json & $touchpad_off & $alert $lock
	bindsym 1 mode $lock $lock_style $exec emacs /home/claudio/workspaces/1nternet.json & $touchpad_off & $alert $lock
	bindsym 2 mode $lock $lock_style $exec emacs /home/claudio/workspaces/2rectory.json & $touchpad_off & $alert $lock
	bindsym p mode $lock $lock_style $exec eog /tmp/latest-screenshot.png & $touchpad_off & $alert $lock
}

bindsym c mode $cnfg $mode_style $exec $alert $cnfg

# mode model:

# set $<name> "<NAME>: alt+<key> to resume  ...  "
#
# mode $<name> {
#	# super
#	bindsym Escape mode $super $super_style $exec $alert_super
#	# lock
#	bindsym space mode $lock $lock_style $exec $touchpad_off & $alert $lock
#	bindsym backslash mode $lock $lock_style $exec $touchpad_off & $alert $lock
#	bindsym Alt_L mode $lock $lock_style $exec $touchpad_off & $alert $lock
#	bindsym Control_L mode $lock $lock_style $exec $touchpad_off & $alert $lock
#	bindsym --border button2 mode $lock $lock_style $exec $touchpad_off_2 & $alert $lock
#	# quit
#	bindsym XF86PowerOff mode $quit $quit_style $exec $alert $quit
#	# options
#         ...
# }
#
# bindsym <key> mode $<name> $mode_style $exec $alert $<name>

############################# LOCK-COMMANDS ####################################

# start a terminal
bindsym Return mode $lock $lock_style $exec i3-sensible-terminal & $touchpad_off & $alert $lock

# open emacs
bindsym e mode $lock $lock_style $exec emacs & $touchpad_off & $alert $lock

# kill
bindsym control+w mode $lock $lock_style kill; $exec $touchpad_off & $alert $lock # kill all for some reason

# enable autoscroll
bindsym control+a mode $lock $lock_style $exec /home/claudio/bin/autoscroll.sh & $touchpad_off & $alert $lock

# save layout
bindsym control+s mode $lock $lock_style exec i3-save-tree > ~/workspaces/stamp.json; $exec $touchpad_off & $alert $lock & emacs /home/claudio/workspaces/stamp.json

# start dmenu (a program launcher)
bindsym control+d mode $lock $lock_style $exec dmenu_run; $exec $touchpad_off & $alert $lock

# There also is the (new) i3-dmenu-desktop which only displays applications
# shipping a .desktop file. It is a wrapper around dmenu, so you need that
# installed.
# Since it's slow as **** someone made an actually good one: https://github.com/matteoalessiocarrara/k5-dmenu-desktop
set $dmenu-desktop i3-dmenu-desktop  #/home/claudio/k5-dmenu-desktop

# Super_L is an escape
bindsym Menu mode $lock $lock_style $exec $dmenu-desktop; $exec $touchpad_off & $alert $lock

# reload the configuration file
bindsym control+r $lock_style reload; $exec $touchpad_off & $alert $lock & i3-msg 'mode $lock'

############################### BAR ############################################

# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
bar {
        status_command    ./bin/my_status.sh
    	position          bottom
    	mode              dock
    	workspace_buttons yes
    	tray_output       primary
    	colors {
    	           background #000000
    	       	   statusline #999999
    	       	   focused_workspace  #ffffff #000000
    	       	   active_workspace   #ffffff #000000
    	       	   inactive_workspace #888888 #000000
    	       	   urgent_workspace   #ffffff #000000
    	       }

        # disable scrolling on status bar
        bindsym button4 nop # scroll wheel up
        bindsym button5 nop # scroll wheel down
    }

################################  COLORS  ######################################

# class                 border  backgr. text    indicator child_border
client.focused          #4CC97E #4CC97E #ffffff #4CC97E   #4CC97E
client.focused_inactive #222222 #222222 #ffffff #222222   #222222
client.unfocused        #222222 #222222 #888888 #222222   #222222
client.urgent           #222222 #900000 #ffffff #900000   #900000
client.placeholder      #000000 #222222 #ffffff #000000   #222222

client.background       #222222

############################### SETTINGS #######################################

# steam
assign [class="Steam"]    $w5
assign [class="Wine"]     $w5
for_window [title="Steam - News"] kill
for_window [title="Friends"] resize shrink width 34 px or 34 ppt
for_window [title="Steam"]   resize grow width 34 px or 34 ppt

# code
assign [title="Visual Studio Code"] $w3

# nautilus desktop confining
assign [title="Desktop"]  $w0

# chromium profile error kill
for_window [title="Profile error occurred"] kill

# skype
assign [class="Skype"]    $w6

# texmaker
assign [title="Texmaker"] $w7

# matlab
assign [class="MATLAB"]   $w7

# no title-bars
new_window pixel 0
new_float normal

# go back to previous workspace if you try to go to the current one
# (i like it becouse it allow for fast window movement to a workspace and back)
workspace_auto_back_and_forth yes

# focus on mouse (is a pain if you happen to have a mouse)
focus_follows_mouse no

# smart|ignore|leave_fullscreen
popup_during_fullscreen leave_fullscreen

############################### STARTUP ########################################

# settings
$exec amixer set -c 1 Speaker set mute; amixer set -c 1 Headphone set unmute
$exec /home/claudio/bin/autoscroll.sh

# applications
$exec classicmenu-indicator & nm-applet
$exec redshift -O 4500K

# layout
$layout_2
$fill_2
